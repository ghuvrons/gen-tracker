(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3],{"8b24":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{class:t.darkerClass},[a("q-splitter",{staticStyle:{height:"calc(100vh - 50px)"},attrs:{horizontal:""},scopedSlots:t._u([{key:"before",fn:function(){return[a("map-management")]},proxy:!0},{key:"separator",fn:function(){return[a("q-avatar",{staticClass:"text-right",attrs:{color:"secondary","text-color":"white",size:"20px",icon:"drag_indicator"}})]},proxy:!0},{key:"after",fn:function(){return[a("q-tabs",{staticClass:"bg-primary text-white",attrs:{dense:""},model:{value:t.selectedTab,callback:function(e){t.selectedTab=e},expression:"selectedTab"}},[a("q-tab",{attrs:{name:"tab-1",label:"Report Log"}},[a("q-badge",{attrs:{color:"red",floating:""}},[t._v(t._s(t.devReports.length))])],1),a("q-tab",{attrs:{name:"tab-2",label:"Driver Management"}},[a("q-badge",{attrs:{color:"red",floating:""}},[t._v(t._s(t.devFingers.length))])],1),a("q-tab",{attrs:{name:"tab-3",label:"Configuration"}})],1),a("q-tab-panels",{class:t.darkerClass,attrs:{"keep-alive":"",animated:"",swipeable:""},model:{value:t.selectedTab,callback:function(e){t.selectedTab=e},expression:"selectedTab"}},[a("q-tab-panel",{attrs:{name:"tab-1"}},[a("report-log",{attrs:{height:t.splitter}})],1),a("q-tab-panel",{attrs:{name:"tab-2"}},[a("driver-management",{attrs:{height:t.splitter}})],1),a("q-tab-panel",{attrs:{name:"tab-3"}},[a("global-configuration",{attrs:{height:t.splitter}})],1)],1)]},proxy:!0}]),model:{value:t.splitter,callback:function(e){t.splitter=e},expression:"splitter"}})],1)},o=[],i=a("ded3"),n=a.n(i),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-splitter",{attrs:{value:t.showStreetView?50:100},scopedSlots:t._u([{key:"before",fn:function(){return[a("gmap-map",{staticClass:"fit",attrs:{center:t.center,zoom:t.zoom,options:t.options,"map-type-id":"roadmap"}},[t.position.valid?a("gmap-marker",{attrs:{position:t.position}}):t._e(),t.path.length>0?a("gmap-polyline",{ref:"polyline",attrs:{path:t.path}}):t._e()],1)]},proxy:!0},t.showStreetView?{key:"separator",fn:function(){return[a("q-avatar",{staticClass:"text-right",attrs:{color:"secondary","text-color":"white",size:"20px",icon:"drag_indicator"}})]},proxy:!0}:null,t.showStreetView?{key:"after",fn:function(){return[a("gmap-street-view-panorama",{staticClass:"fit",attrs:{position:t.position,pov:t.pov,zoom:1},on:{pano_changed:t.updatePano,pov_changed:t.updatePov}})]},proxy:!0}:null],null,!0)})},s=[],c=a("4082"),d=a.n(c),p=a("110e");const m=({lng:t,lat:e})=>{let{borderIndonesia:a}=p["b"].map;return t>a.lngMin&&t<a.lngMax&&e>a.latMin&&e<a.latMax},u=({frameID:t,lat:e,lng:a})=>{let r=n()(n()({},p["b"].map.centerIndonesia),{},{valid:!1});return t===p["b"].frame.id.FULL&&(r.lat=e,r.lng=a,r.valid=m(r)),r},h=({frameID:t,heading:e})=>t===p["b"].frame.id.FULL?e:0;var b=a("d87e"),g=a("2f62"),f={data(){return{center:n()({},p["b"].map.centerIndonesia),position:n()(n()({},p["b"].map.centerIndonesia),{},{valid:!1}),zoom:p["b"].map.zoom,pov:null,pano:null,path:[],options:{zoomControl:!0,mapTypeControl:!1,scaleControl:!0,streetViewControl:!1,rotateControl:!1,fullscreenControl:!0,disableDefaultUi:!0}}},computed:n()(n()(n()({},Object(g["e"])("db",["theReport"])),Object(g["c"])("db",[b["d"]])),{},{showStreetView(){return this.$q.screen.gt.sm}}),methods:{updatePov(t){this.pov=t},updatePano(t){this.pano=t},setPosition(t){let{valid:e}=t,a=d()(t,["valid"]);e?(this.zoom=17,this.center=n()({},a)):(this.zoom=p["b"].map.zoom,this.center=n()({},p["b"].map.centerIndonesia)),this.position=n()(n()({},a),{},{valid:e})}},watch:{devReports:{immediate:!0,handler(t){if(t.length>0){let{frameID:e,gpsLatitude:a,gpsLongitude:r}=t[0],o=u({frameID:e.val,lat:a&&a.val,lng:r&&r.val});o.valid&&this.path.push(o)}}},theReport:{immediate:!0,handler(t){if(t){let{frameID:e,gpsLatitude:a,gpsLongitude:r,gpsHeading:o}=t;this.setPosition(u({frameID:e.val,lat:a&&a.val,lng:r&&r.val})),this.pov&&this.updatePov(n()(n()({},this.pov),{},{heading:h({frameID:e.val,heading:o&&o.val})}))}}}}},v=f,k=a("2877"),q=a("8562"),x=a("cb32"),_=a("eebe"),C=a.n(_),y=Object(k["a"])(v,l,s,!1,null,null,null),S=y.exports;C()(y,"components",{QSplitter:q["a"],QAvatar:x["a"]});var w=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{style:"height: calc(100vh - "+t.height+"vh - 105px)"},[a("q-virtual-scroll",{attrs:{items:t.devReports,separator:""},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.item,o=e.index;return[a("q-item",{key:o,attrs:{dark:t.darker,active:r.hex===t.theReport.hex,"active-class":"bg-primary text-white",clickable:"",dense:""},on:{click:function(e){return t.SET_THE_REPORT(r)}}},[a("q-item-section",{attrs:{avatar:""}},[a("div",[a("q-chip",{staticClass:"q-ml-sm text-center",staticStyle:{width:"60px"},attrs:{color:"FULL"==r.frameID.out?"green":"light-green",dark:"",dense:"",square:""}},[t._v("\n              "+t._s(r.frameID.out)+"\n            ")]),a("q-chip",{attrs:{color:"primary",dark:"",dense:"",square:""}},[t._v("\n              "+t._s(t.getDatetime(r))+"\n            ")])],1)]),a("q-item-section",[a("q-item-label",{staticClass:"ellipsis"},[t._v("\n            "+t._s(r.hex)+"\n          ")])],1)],1)]}},{key:"after",fn:function(){return[0==t.devReports.length?a("q-banner",{attrs:{dark:t.darker},scopedSlots:t._u([{key:"avatar",fn:function(){return[a("q-icon",{attrs:{name:"info"}})]},proxy:!0}],null,!1,1899737995)},[t._v("\n        No report yet\n      ")]):t._e()]},proxy:!0}])}),a("q-page-sticky",{attrs:{position:"bottom-right",offset:[18,18]}},[a("q-btn",{attrs:{icon:t.lock.follow?"lock":"lock_open",disable:0==t.devReports.length,loading:t.loading,color:t.lock.follow?"secondary":"grey","fab-mini":""},on:{click:function(e){t.lock.follow=!t.lock.follow}}},[a("q-tooltip",{attrs:{anchor:"top middle",self:"bottom middle"}},[t._v("\n        "+t._s(t.lock.follow?"Unfollow":"Follow")+"\n      ")])],1)],1)],1)},I=[],D=a("1a0d"),O=a("a7bc"),R=a("ae51"),E={mixins:[R["a"]],props:{height:{required:!0}},data(){return{lock:{follow:!0}}},computed:n()(n()({},Object(g["e"])("db",["theUnit","theReport"])),Object(g["c"])("db",[b["d"]])),methods:n()(n()({},Object(g["d"])("db",[O["m"]])),{},{getDatetime({logDatetime:t}){return Object(D["i"])(t.val)}}),watch:{height:function(t){console.warn(t)},devReports:{immediate:!0,handler(t){t.length>0&&this.lock.follow&&this.SET_THE_REPORT(t[0])}}}},T=E,F=a("a12b"),Q=a("66e5"),$=a("4074"),j=a("b047"),L=a("0170"),N=a("54e1"),A=a("0016"),G=a("de5e"),P=a("9c40"),z=a("05c0"),M=Object(k["a"])(T,w,I,!1,null,null,null),U=M.exports;C()(M,"components",{QVirtualScroll:F["a"],QItem:Q["a"],QItemSection:$["a"],QChip:j["a"],QItemLabel:L["a"],QBanner:N["a"],QIcon:A["a"],QPageSticky:G["a"],QBtn:P["a"],QTooltip:z["a"]});var V=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{style:"height: calc(100vh - "+t.height+"vh - 105px)"},[a("q-virtual-scroll",{attrs:{items:t.devFingers,separator:""},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.item,o=e.index;return[a("q-item",{key:o,attrs:{dark:t.darker}},[a("q-item-section",{attrs:{avatar:""}},[a("q-chip",{attrs:{color:"primary",dark:"",square:""}},[t._v("\n            "+t._s(r.fingerID)+"\n          ")])],1),a("q-item-section",[a("q-item-label",[t._v(" Mr. "+t._s(t.name[r.fingerID-1]))])],1),a("q-item-section",{attrs:{side:""}},[a("q-btn",{attrs:{loading:t.loading,size:"sm",icon:"delete",outline:"",unelevated:"",round:""},on:{click:function(e){return t.deleteFinger(r)}}})],1)],1)]}},{key:"after",fn:function(){return[0==t.devFingers.length?a("q-banner",{attrs:{dark:t.darker},scopedSlots:t._u([{key:"avatar",fn:function(){return[a("q-icon",{attrs:{name:"info"}})]},proxy:!0}],null,!1,1899737995)},[t._v("\n        No finger driver yet\n      ")]):t._e()]},proxy:!0}])}),a("q-page-sticky",{attrs:{position:"bottom-right",offset:[18,18]}},[a("q-fab",{attrs:{"external-label":"","vertical-actions-align":"right",color:"secondary",icon:"keyboard_arrow_left",direction:"left","label-position":"top",padding:"sm"},model:{value:t.fab,callback:function(e){t.fab=e},expression:"fab"}},[a("q-fab-action",{attrs:{disable:t.loading||!t.theUnit,"label-position":"top",color:"primary",icon:"download",label:"Fetch","external-label":""},on:{click:t.fetchFinger}}),a("q-fab-action",{attrs:{disable:t.loading||!t.theUnit,"label-position":"top",color:"green",icon:"upload",label:"Add","external-label":""},on:{click:t.addFinger}}),a("q-fab-action",{attrs:{disable:t.loading||!t.theUnit,"label-position":"top",color:"orange",icon:"delete_forever",label:"Reset","external-label":""},on:{click:t.resetFinger}})],1)],1)],1)},B=[],H=a("95f8"),J=a("595a"),K=a("5f41"),Y={mixins:[R["a"]],props:{height:{required:!0}},data(){return{name:["One","Two","Three","Four","Five"],fab:!1}},computed:n()(n()({},Object(g["e"])("db",["theUnit","commands"])),Object(g["c"])("db",[b["c"],b["d"]])),mounted(){this.devReports.length>0&&this.devReports[0].vehicleState.out>=K["b"]["STANDBY"]&&this.fetchFinger()},methods:n()(n()({},Object(g["d"])("db",[O["b"],O["h"],O["i"]])),{},{fetchFinger(){this.$root.$emit("executeCommand","FINGER_FETCH")},addFinger(){this.$root.$emit("executeCommand","FINGER_ADD")},deleteFinger({fingerID:t}){this.$q.dialog({title:"Confirmation",message:`Are you sure to remove this fingerprint *${t}* ?`,dark:this.darker,preventClose:!0,cancel:!0}).onOk((()=>this.$root.$emit("executeCommand",`FINGER_DEL=${t}`)))},resetFinger(){this.$q.dialog({title:"Confirmation",message:"Are you sure to remove all fingerprints  ?",dark:this.darker,preventClose:!0,cancel:!0}).onOk((()=>this.$root.$emit("executeCommand","FINGER_RST")))}}),watch:{commands:{deep:!0,handler(t){if(t.length>0){let{resCode:e,payload:a,unitID:r,message:o}=t[0],i=Object(J["a"])(e);if("OK"==i.title){let{prop:t,value:e}=Object(H["b"])(a);if("FINGER_FETCH"==t){if(o.length>0){let t=o.split(",");for(let e=t.length-1;e>=0;e--)this.ADD_FINGERS({unitID:r,fingerID:t[e]})}}else"FINGER_ADD"==t?this.ADD_FINGERS({unitID:r,fingerID:o}):"FINGER_DEL"==t?this.DELETE_FINGERS({unitID:r,fingerID:e}):"FINGER_RST"==t&&this.RESET_FINGERS({unitID:r})}}}}}},W=Y,X=a("c294"),Z=a("72db"),tt=Object(k["a"])(W,V,B,!1,null,null,null),et=tt.exports;C()(tt,"components",{QVirtualScroll:F["a"],QItem:Q["a"],QItemSection:$["a"],QChip:j["a"],QItemLabel:L["a"],QBtn:P["a"],QBanner:N["a"],QIcon:A["a"],QPageSticky:G["a"],QFab:X["a"],QFabAction:Z["a"]});var at=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{style:"height: calc(100vh - "+t.height+"vh - 105px)"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-auto q-ma-sm"},[a("q-btn",{staticClass:"q-ma-xs",attrs:{icon:"delete",color:"negative",label:"Clear data",disable:0==t.units.length},on:{click:function(e){return t.clearStore()}}})],1),a("div",{staticClass:"col-auto q-ma-sm"},[a("q-btn",{staticClass:"q-ma-xs",attrs:{icon:"stop",color:"primary",label:"Ignore command",disable:!t.theCommand},on:{click:function(e){return t.$root.$emit("ignoreCommand")}}})],1),a("div",{staticClass:"col-auto q-ma-sm"},[a("q-btn",{staticClass:"q-ma-xs",attrs:{icon:"cloud_download",color:"green",label:"Export CSV",disable:0==t.reports.length},nativeOn:{click:function(e){return t.exportCSV()}}})],1),a("div",{staticClass:"col-auto q-ma-sm"},[a("q-btn",{staticClass:"q-ma-xs",attrs:{icon:"cloud_download",color:"purple",label:"Export JSON",disable:0==t.reports.length},nativeOn:{click:function(e){return t.exportJSON()}}})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-auto q-ma-sm"},[a("q-uploader",{ref:"importer",staticClass:"q-ma-sm",attrs:{factory:t.importJSON,dark:t.darker,accept:".json",label:"Import JSON"},on:{finish:t.finish}})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-auto q-ma-sm"},[a("q-toggle",{staticClass:"q-pt-lg",attrs:{dark:t.darker,label:"Dark Mode"},model:{value:t.darkState,callback:function(e){t.darkState=e},expression:"darkState"}})],1),a("div",{staticClass:"col-auto q-ma-sm"},[a("q-toggle",{staticClass:"q-pt-lg",attrs:{disable:0==t.units.length,dark:t.darker,label:"Time Calibration"},model:{value:t.calibrationState,callback:function(e){t.calibrationState=e},expression:"calibrationState"}})],1)])])},rt=[],ot=(a("e6cf"),a("6ad4")),it=(a("13d5"),a("26e9"),a("ab1c")),nt=a("f23f"),lt=a("2e92"),st=a("c1df"),ct=a.n(st);const dt=t=>t.map((t=>n()({},it["a"].reduce(((e,{field:a,no:r})=>n()(n()({},e),{},{[r]:t[a]?t[a].out:""})),{})))),pt=()=>it["a"].reduce(((t,{title:e,unit:a})=>t.concat([e+(a?` (${a})`:"")])),[]),mt=t=>{const e=new nt["ExportToCsv"]({fieldSeparator:",",quoteStrings:'"',decimalSeparator:".",showLabels:!0,showTitle:!1,title:"My Awesome CSV",useTextFile:!1,useBom:!0,useKeysAsHeaders:!1,headers:pt()});e.generateCsv(dt(t))},ut=t=>t?t.reverse().map((({hex:t})=>t)):[],ht=t=>{const e=`tracking-${ct()().format("YYMMDDHHmmss")}`,a=ut(t),r="json";Object(lt["a"])({data:a,fileName:e,exportType:r})};var bt={mixins:[R["a"]],props:{height:{required:!0}},computed:n()(n()(n()({},Object(g["e"])("db",["units","calibration","theCommand","reports","commands"])),Object(g["c"])("db",[b["d"]])),{},{calibrationState:{get(){return this.calibration},set(t){this.TOGGLE_CALIBRATION()}},darkState:{get(){return this.darker},set(t){this.TOGGLE_DARKER()}}}),methods:n()(n()(n()({},Object(g["d"])("db",[O["o"],O["p"]])),Object(g["b"])("db",[ot["c"]])),{},{finish(){this.$refs.importer.reset()},exportJSON(){ht(this.reports)},exportCSV(){mt(this.reports)},importJSON(t){return new Promise(((e,a)=>{if(0==this.reports.length){let a=new FileReader;a.onload=t=>{this.$root.$emit("importData",JSON.parse(t.target.result)),e()},a.readAsText(t[0])}else this.$q.notify({message:"Database should empty",type:"negative"}),a()}))},clearStore(){this.$q.dialog({title:"Confirmation",message:"Are you sure to remove all data?",dark:this.darker,preventClose:!0,cancel:!0}).onOk((()=>this.RESET_DATABASE()))}}),watch:{devReports:function(t){if(t.length>0&&this.calibration){let{frameID:e,gpsLatitude:a,gpsLongitude:r,sendDatetime:o}=t[0];if(e.val===this.$config.frame.id.FULL){let t=Object(D["b"])({lat:a.val,lng:r.val,datetime:o.val});t&&(this.$root.$emit("executeCommand",`REPORT_RTC=${t}`),this.$q.notify({message:"Calibrating device time.."}))}}}}},gt=bt,ft=a("ee89"),vt=a("9564"),kt=Object(k["a"])(gt,at,rt,!1,null,null,null),qt=kt.exports;C()(kt,"components",{QBtn:P["a"],QUploader:ft["a"],QToggle:vt["a"]});var xt={mixins:[R["a"]],components:{MapManagement:S,ReportLog:U,DriverManagement:et,GlobalConfiguration:qt},data(){return{selectedTab:"tab-1",mapHeight:300,paneHeight:0,pageWidth:0,splitter:50}},computed:n()({},Object(g["c"])("db",[b["d"],b["c"]]))},_t=xt,Ct=a("9989"),yt=a("429b"),St=a("7460"),wt=a("58a81"),It=a("adad"),Dt=a("823b"),Ot=Object(k["a"])(_t,r,o,!1,null,null,null);e["default"]=Ot.exports;C()(Ot,"components",{QPage:Ct["a"],QSplitter:q["a"],QAvatar:x["a"],QTabs:yt["a"],QTab:St["a"],QBadge:wt["a"],QTabPanels:It["a"],QTabPanel:Dt["a"]})},ae51:function(t,e,a){"use strict";var r=a("ded3"),o=a.n(r),i=a("2f62");e["a"]={computed:o()(o()({},Object(i["e"])("db",["loading","darker"])),{},{darkerClass(){return this.darker?"bg-dark text-white":"bg-white text-grey-9"}})}}}]);