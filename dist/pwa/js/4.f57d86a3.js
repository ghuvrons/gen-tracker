(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"8b24":function(e,t,l){"use strict";l.r(t);var c=l("7a23");function a(e,t,l,a,o,b){const n=Object(c["H"])("map-management"),r=Object(c["H"])("q-avatar"),i=Object(c["H"])("q-badge"),s=Object(c["H"])("q-tab"),O=Object(c["H"])("q-tabs"),j=Object(c["H"])("report-log"),d=Object(c["H"])("q-tab-panel"),u=Object(c["H"])("driver-management"),p=Object(c["H"])("global-configuration"),m=Object(c["H"])("q-tab-panels"),f=Object(c["H"])("q-splitter"),v=Object(c["H"])("q-page");return Object(c["B"])(),Object(c["h"])(v,null,{default:Object(c["S"])((()=>[Object(c["l"])(f,{modelValue:e.splitter,"onUpdate:modelValue":t[3]||(t[3]=t=>e.splitter=t),style:{height:"calc(100vh - 50px)"},horizontal:""},{before:Object(c["S"])((()=>[Object(c["l"])(n)])),separator:Object(c["S"])((()=>[Object(c["l"])(r,{color:"grey","text-color":"white",size:"20px",icon:"drag_indicator"})])),after:Object(c["S"])((()=>[Object(c["l"])(O,{modelValue:e.selectedTab,"onUpdate:modelValue":t[1]||(t[1]=t=>e.selectedTab=t),class:"bg-primary text-white",dense:""},{default:Object(c["S"])((()=>[Object(c["l"])(s,{name:"tab-1",label:"Report Log"},{default:Object(c["S"])((()=>[Object(c["l"])(i,{color:"red",floating:""},{default:Object(c["S"])((()=>[Object(c["k"])(Object(c["L"])(e.devReports.length),1)])),_:1})])),_:1}),Object(c["l"])(s,{name:"tab-2",label:"Driver Management"},{default:Object(c["S"])((()=>[Object(c["l"])(i,{color:"red",floating:""},{default:Object(c["S"])((()=>[Object(c["k"])(Object(c["L"])(e.devFingers.length),1)])),_:1})])),_:1}),Object(c["l"])(s,{name:"tab-3",label:"Configuration"})])),_:1},8,["modelValue"]),Object(c["l"])(m,{modelValue:e.selectedTab,"onUpdate:modelValue":t[2]||(t[2]=t=>e.selectedTab=t),swipeable:""},{default:Object(c["S"])((()=>[Object(c["l"])(d,{name:"tab-1"},{default:Object(c["S"])((()=>[Object(c["l"])(j,{"content-style":e.contentStyle},null,8,["content-style"])])),_:1}),Object(c["l"])(d,{name:"tab-2"},{default:Object(c["S"])((()=>[Object(c["l"])(u,{"content-style":e.contentStyle},null,8,["content-style"])])),_:1}),Object(c["l"])(d,{name:"tab-3"},{default:Object(c["S"])((()=>[Object(c["l"])(p,{"content-style":e.contentStyle},null,8,["content-style"])])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])])),_:1})}const o=Object(c["k"])(" No report yet ");function b(e,t,l,a,b,n){const r=Object(c["H"])("q-icon"),i=Object(c["H"])("q-banner"),s=Object(c["H"])("q-chip"),O=Object(c["H"])("q-item-section"),j=Object(c["H"])("q-item-label"),d=Object(c["H"])("q-item"),u=Object(c["H"])("q-virtual-scroll"),p=Object(c["H"])("q-tooltip"),m=Object(c["H"])("q-btn"),f=Object(c["H"])("q-page-sticky");return Object(c["B"])(),Object(c["h"])("div",{style:e.contentStyle},[0==e.devReports.length?(Object(c["B"])(),Object(c["h"])(i,{key:0},{avatar:Object(c["S"])((()=>[Object(c["l"])(r,{name:"info"})])),default:Object(c["S"])((()=>[o])),_:1})):(Object(c["B"])(),Object(c["h"])(u,{key:1,items:e.devReports,separator:""},{default:Object(c["S"])((({item:t,index:l})=>[Object(c["l"])(d,{key:l,active:t.hex===e.report.hex,"active-class":"bg-primary text-white",onClick:l=>e.setReport(t),clickable:"",dense:""},{default:Object(c["S"])((()=>[Object(c["l"])(O,{avatar:""},{default:Object(c["S"])((()=>[Object(c["l"])("div",null,[Object(c["l"])(s,{color:"FULL"==t.frameID.out?"green":"light-green",class:"q-ml-sm text-center",style:{width:"60px"},dark:"",dense:"",square:""},{default:Object(c["S"])((()=>[Object(c["k"])(Object(c["L"])(t.frameID.out),1)])),_:2},1032,["color"]),Object(c["l"])(s,{color:"primary",dark:"",dense:"",square:""},{default:Object(c["S"])((()=>[Object(c["k"])(Object(c["L"])(e.getDatetime(t.logDatetime)),1)])),_:2},1024)])])),_:2},1024),Object(c["l"])(O,null,{default:Object(c["S"])((()=>[Object(c["l"])(j,{class:"ellipsis"},{default:Object(c["S"])((()=>[Object(c["k"])(Object(c["L"])(t.hex),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["active","onClick"])])),_:1},8,["items"])),Object(c["l"])(f,{position:"bottom-right",offset:[18,18]},{default:Object(c["S"])((()=>[Object(c["l"])(m,{onClick:t[1]||(t[1]=t=>e.followState=!e.followState),icon:e.followState?"lock":"lock_open",color:e.followState?"secondary":"grey",disable:0==e.devReports.length,"fab-mini":""},{default:Object(c["S"])((()=>[Object(c["l"])(p,{anchor:"top middle",self:"bottom middle"},{default:Object(c["S"])((()=>[Object(c["k"])(Object(c["L"])(e.followState?"Unfollow":"Follow"),1)])),_:1})])),_:1},8,["icon","color","disable"])])),_:1})],4)}var n=l("cfbf"),r=l("a7bc"),i=l("5662"),s=l("5502"),O=Object(c["m"])({props:{contentStyle:{type:String,required:!0}},setup(e){const t=Object(s["b"])(),l=Object(c["f"])((()=>t.state.db.report)),a=Object(c["f"])((()=>t.getters["db/devReports"])),o=e=>t.commit(r["k"],e),b=Object(c["f"])((()=>t.state.common.follow)),O=e=>t.commit(i["b"],e),j=Object(c["f"])({get:()=>b.value,set:e=>O(e)}),d=e=>n["a"].unix(e.val).format("HH:mm:ss");return{report:l,devReports:a,followState:j,setReport:o,getDatetime:d}}}),j=l("54e1"),d=l("0016"),u=l("a12b"),p=l("66e5"),m=l("4074"),f=l("b047"),v=l("0170"),g=l("de5e"),S=l("9c40"),h=l("05c0"),k=l("eebe"),y=l.n(k);O.render=b;var H=O;function q(e,t,l,a,o,b){const n=Object(c["H"])("q-resize-observer"),r=Object(c["H"])("Marker"),i=Object(c["H"])("Polyline"),s=Object(c["H"])("GoogleMap"),O=Object(c["H"])("q-avatar"),j=Object(c["H"])("q-splitter");return Object(c["B"])(),Object(c["h"])(j,{"model-value":e.streetView?50:100},Object(c["j"])({before:Object(c["S"])((()=>[Object(c["l"])(s,{"api-key":"AIzaSyBE8UhrrFkz9m37oowPkHX9to8NXcHw4Ak",class:"fit",center:e.center,zoom:e.zoom},{default:Object(c["S"])((()=>[e.position.valid?(Object(c["B"])(),Object(c["h"])(r,{key:0,options:{position:e.center,icon:e.icon}},null,8,["options"])):Object(c["i"])("",!0),Object(c["l"])(i,{options:e.polyOptions},null,8,["options"])])),_:1},8,["center","zoom"])])),default:Object(c["S"])((()=>[Object(c["l"])(n,{onResize:t[1]||(t[1]=t=>e.width=t.width)})])),_:2},[e.streetView?{name:"separator",fn:Object(c["S"])((()=>[Object(c["l"])(O,{color:"grey","text-color":"white",size:"20px",icon:"drag_indicator"})]))}:void 0,e.streetView?{name:"after",fn:Object(c["S"])((()=>[]))}:void 0]),1032,["model-value"])}y()(O,"components",{QBanner:j["a"],QIcon:d["a"],QVirtualScroll:u["a"],QItem:p["a"],QItemSection:m["a"],QChip:f["a"],QItemLabel:v["a"],QPageSticky:g["a"],QBtn:S["a"],QTooltip:h["a"]});var _=l("4082"),w=l.n(_),C=l("ded3"),x=l.n(C),Q=l("9482"),D=l("af6a"),R=l("2ef0"),I=l("9944");const F=({lng:e,lat:t})=>{let{borderIndonesia:l}=Q["a"].map;return e>l.lngMin&&e<l.lngMax&&t>l.latMin&&t<l.latMax},L=e=>{let t=x()(x()({},Q["a"].map.centerIndonesia),{},{valid:!1});return"FULL"==Object(I["e"])(Object(R["get"])(e,"frameID.val"))&&(t.lat=Object(R["get"])(e,"gpsLatitude.val"),t.lng=Object(R["get"])(e,"gpsLongitude.val"),t.valid=F(t)),t},T=e=>"FULL"==Object(I["e"])(Object(R["get"])(e,"frameID.val"))?Object(R["get"])(e,"gpsHeading.val"):0;var V=l("7ec9"),B=Object(c["m"])({components:{GoogleMap:V["a"],Marker:V["b"],Polyline:V["c"]},setup(e){const t=Object(s["b"])(),l=Object(c["f"])((()=>t.state.db.report)),a=Object(c["f"])((()=>t.getters["db/devDevice"])),o=Object(c["f"])((()=>t.getters["db/devReports"])),{centerIndonesia:b,zoom:n}=Q["a"].map,r=Object(c["D"])({zoom:n,icon:null,width:0,pov:null,pano:null,path:[],center:x()({},b),position:x()(x()({},b),{},{valid:!1}),options:{zoomControl:!0,mapTypeControl:!1,scaleControl:!0,streetViewControl:!1,rotateControl:!1,fullscreenControl:!0,disableDefaultUi:!0}}),i=e=>r.pov=x()(x()({},e),{},{zoom:0}),O=e=>r.pano=e,j=e=>{let{valid:t}=e,l=w()(e,["valid"]);r.zoom=t?17:n,r.center=x()({},t?l:b),r.position=x()(x()({},l),{},{valid:t})},d=e=>{const t=L(e);t.valid&&r.path.push(t)},u=Object(c["f"])((()=>!1)),p=Object(c["f"])((()=>({path:r.path,geodesic:!1,strokeColor:"#000",strokeOpacity:.75,strokeWeight:5})));return Object(c["z"])((()=>{const{protocol:e,host:t}=window.location;r.icon=`${e}//${t}/motorcycle.png`})),Object(c["R"])((()=>a.value),((e,t)=>{if(Object(R["get"])(e,"unitID")!=Object(R["get"])(t,"unitID"))r.path=[],o.value.filter((({frameID:e})=>"FULL"==Object(I["e"])(e.val))).forEach((e=>d(e)));else{const t=Object(R["get"])(e,"lastFullReport");d(t)}}),{lazy:!1,immediate:!0,deep:!0}),Object(c["R"])((()=>l.value),((e,t)=>{const l="FULL"==Object(I["e"])(Object(R["get"])(e,"frameID.val")),c=l?e:Object(D["c"])(e,o.value),a=L(c);j(a),(Object(R["get"])(e,"unitID.val")!=Object(R["get"])(t,"unitID.val")||a.valid)&&j(a),r.pov&&i(x()(x()({},r.pov),{},{heading:T(e)}))}),{lazy:!1,immediate:!0}),x()(x()({},Object(c["O"])(r)),{},{streetView:u,polyOptions:p,updatePov:i,updatePano:O})}}),z=l("8562"),M=l("3980"),E=l("cb32");B.render=q;var U=B;y()(B,"components",{QSplitter:z["a"],QResizeObserver:M["a"],QAvatar:E["a"]});const A={class:"text-subtitle2"},N=Object(c["k"])(" No finger driver yet ");function P(e,t,l,a,o,b){const n=Object(c["H"])("q-icon"),r=Object(c["H"])("q-banner"),i=Object(c["H"])("q-chip"),s=Object(c["H"])("q-item-section"),O=Object(c["H"])("q-item-label"),j=Object(c["H"])("q-btn"),d=Object(c["H"])("q-item"),u=Object(c["H"])("q-virtual-scroll"),p=Object(c["H"])("q-fab-action"),m=Object(c["H"])("q-fab"),f=Object(c["H"])("q-page-sticky");return Object(c["B"])(),Object(c["h"])("div",{style:e.contentStyle},[Object(c["l"])("div",A,"Last fetch: "+Object(c["L"])(e.getFingerTime()),1),0==e.devFingers.length?(Object(c["B"])(),Object(c["h"])(r,{key:0},{avatar:Object(c["S"])((()=>[Object(c["l"])(n,{name:"info"})])),default:Object(c["S"])((()=>[N])),_:1})):(Object(c["B"])(),Object(c["h"])(u,{key:1,items:e.devFingers,separator:""},{default:Object(c["S"])((({item:t,index:l})=>[Object(c["l"])(d,{key:l,dense:""},{default:Object(c["S"])((()=>[Object(c["l"])(s,{avatar:""},{default:Object(c["S"])((()=>[Object(c["l"])(i,{color:"primary",dark:"",square:""},{default:Object(c["S"])((()=>[Object(c["k"])(Object(c["L"])(t.fingerID),1)])),_:2},1024)])),_:2},1024),Object(c["l"])(s,null,{default:Object(c["S"])((()=>[Object(c["l"])(O,null,{default:Object(c["S"])((()=>[Object(c["k"])("Mr. "+Object(c["L"])(e.name[t.fingerID-1]),1)])),_:2},1024)])),_:2},1024),Object(c["l"])(s,{side:""},{default:Object(c["S"])((()=>[Object(c["l"])(j,{onClick:l=>e.remove(t),size:"sm",icon:"delete",outline:"",unelevated:"",round:""},null,8,["onClick"])])),_:2},1024)])),_:2},1024)])),_:1},8,["items"])),Object(c["l"])(f,{position:"bottom-right",offset:[18,18]},{default:Object(c["S"])((()=>[Object(c["l"])(m,{modelValue:e.fab,"onUpdate:modelValue":t[1]||(t[1]=t=>e.fab=t),"external-label":"","vertical-actions-align":"right",color:"secondary",icon:"keyboard_arrow_left",direction:"left","label-position":"top",padding:"sm"},{default:Object(c["S"])((()=>[Object(c["l"])(p,{onClick:e.fetch,disable:!e.devDevice,"label-position":"top",color:"primary",icon:"download",label:"Fetch","external-label":""},null,8,["onClick","disable"]),Object(c["l"])(p,{onClick:e.add,disable:!e.devDevice,"label-position":"top",color:"green",icon:"upload",label:"Add","external-label":""},null,8,["onClick","disable"]),Object(c["l"])(p,{onClick:e.clear,disable:!e.devDevice,"label-position":"top",color:"orange",icon:"delete_forever",label:"Reset","external-label":""},null,8,["onClick","disable"])])),_:1},8,["modelValue"])])),_:1})],4)}var $=l("b7fa"),G=Object(c["m"])({props:{contentStyle:{type:String,required:!0}},setup(e){const t=Object(c["p"])("sendCommand"),l=Object(s["b"])(),a=Object(c["f"])((()=>l.getters["db/devDevice"])),o=Object(c["f"])((()=>l.getters["db/devFingers"])),b=Object(c["E"])(["One","Two","Three","Four","Five"]),r=Object(c["E"])(!1),i=()=>{let e=Object(R["get"])(a.value,"fingerTime");return e?n["a"].unix(e).format("DD-MM-YY HH:mm:ss"):"Unknown"},O=()=>t("FINGER_FETCH"),j=()=>t("FINGER_ADD"),d=({fingerID:e})=>Object($["a"])(`Are you sure to remove this fingerprint ${e} ?`).onOk((()=>t(`FINGER_DEL=${e}`))),u=()=>Object($["a"])("Are you sure to clear all fingerprints  ?").onOk((()=>t("FINGER_RST")));return{name:b,fab:r,devFingers:o,devDevice:a,getFingerTime:i,fetch:O,add:j,remove:d,clear:u}}}),J=l("c294"),Y=l("72db");G.render=P;var X=G;y()(G,"components",{QBanner:j["a"],QIcon:d["a"],QVirtualScroll:u["a"],QItem:p["a"],QItemSection:m["a"],QChip:f["a"],QItemLabel:v["a"],QBtn:S["a"],QPageSticky:g["a"],QFab:J["a"],QFabAction:Y["a"]});const K={class:"row q-gutter-xs"},W={class:"col-auto"},Z={key:0,class:"col-auto"},ee={class:"col-auto"},te={class:"col-auto"},le={class:"col-auto"},ce=Object(c["k"])("CSV"),ae=Object(c["k"])("JSON"),oe={class:"row q-gutter-xs q-mt-xs"},be={class:"col-auto"},ne={class:"row q-gutter-xs q-mt-xs"},re={class:"col-auto"};function ie(e,t,l,a,o,b){const n=Object(c["H"])("q-btn"),r=Object(c["H"])("q-item-label"),i=Object(c["H"])("q-item-section"),s=Object(c["H"])("q-item"),O=Object(c["H"])("q-list"),j=Object(c["H"])("q-btn-dropdown"),d=Object(c["H"])("q-uploader"),u=Object(c["H"])("q-toggle"),p=Object(c["I"])("close-popup");return Object(c["B"])(),Object(c["h"])("div",{style:e.contentStyle},[Object(c["l"])("div",K,[Object(c["l"])("div",W,[Object(c["l"])(n,{icon:"delete",label:"Reset DB",disable:0==e.devices.length,onClick:t[1]||(t[1]=t=>e.clearStore())},null,8,["disable"])]),e.$q.fullscreen.isCapable?(Object(c["B"])(),Object(c["h"])("div",Z,[Object(c["l"])(n,{onClick:t[2]||(t[2]=t=>e.$q.fullscreen.toggle()),label:e.$q.fullscreen.isActive?"Full OFF":"Full ON",icon:e.$q.fullscreen.isActive?"fullscreen_exit":"fullscreen"},null,8,["label","icon"])])):Object(c["i"])("",!0),Object(c["l"])("div",ee,[Object(c["l"])(n,{icon:"alarm_on",label:"Calibrate",disable:0==e.devReports.length,onClick:t[3]||(t[3]=t=>e.calibrate())},null,8,["disable"])]),Object(c["l"])("div",te,[Object(c["l"])(n,{icon:"stop",label:"Commandable",onClick:t[4]||(t[4]=t=>e.ignoreResponse())})]),Object(c["l"])("div",le,[Object(c["l"])(j,{icon:"cloud_download",label:"Export"},{default:Object(c["S"])((()=>[Object(c["l"])(O,null,{default:Object(c["S"])((()=>[Object(c["T"])(Object(c["l"])(s,{clickable:e.reports.length>0,onClick:t[5]||(t[5]=t=>e.exportCSV(e.reports))},{default:Object(c["S"])((()=>[Object(c["l"])(i,null,{default:Object(c["S"])((()=>[Object(c["l"])(r,null,{default:Object(c["S"])((()=>[ce])),_:1})])),_:1})])),_:1},8,["clickable"]),[[p]]),Object(c["T"])(Object(c["l"])(s,{clickable:e.reports.length>0,onClick:t[6]||(t[6]=t=>e.exportJSON(e.reports))},{default:Object(c["S"])((()=>[Object(c["l"])(i,null,{default:Object(c["S"])((()=>[Object(c["l"])(r,null,{default:Object(c["S"])((()=>[ae])),_:1})])),_:1})])),_:1},8,["clickable"]),[[p]])])),_:1})])),_:1})])]),Object(c["l"])("div",oe,[Object(c["l"])("div",be,[Object(c["l"])(d,{ref:"uploader",factory:e.importData,accept:".json",label:"Import JSON","auto-upload":""},null,8,["factory"])])]),Object(c["l"])("div",ne,[Object(c["l"])("div",re,[Object(c["l"])(u,{modelValue:e.notificationState,"onUpdate:modelValue":t[7]||(t[7]=t=>e.notificationState=t),label:"Notification"},null,8,["modelValue"])])])],4)}l("ddb0"),l("13d5"),l("26e9"),l("e6cf");var se=l("f23f"),Oe=l("2e92");const je=e=>e.map((e=>x()({},D["a"].reduce(((t,{field:l,no:c})=>x()(x()({},t),{},{[c]:e[l]?e[l].out:""})),{})))),de=()=>D["a"].reduce(((e,{title:t,unit:l})=>e.concat([t+(l?` (${l})`:"")])),[]),ue=e=>{const t=new se["ExportToCsv"]({fieldSeparator:",",quoteStrings:'"',decimalSeparator:".",showLabels:!0,showTitle:!1,title:"My Awesome CSV",useTextFile:!1,useBom:!0,useKeysAsHeaders:!1,headers:de()});t.generateCsv(je(e))},pe=e=>e?e.map((({hex:e})=>e)):[],me=e=>{const t=`tracking-${Object(n["a"])().format("YYMMDDHHmmss")}`,l=pe(e.slice().reverse()),c="json";Object(Oe["a"])({data:l,fileName:t,exportType:c})},fe=e=>new Promise(((t,l)=>{e||l();let c=new FileReader;c.onload=e=>t(JSON.parse(e.target.result)),c.readAsText(e)}));var ve=l("6ad4"),ge=Object(c["m"])({props:{contentStyle:{type:String,required:!0}},setup(e){const t=Object(c["p"])("sendCommand"),l=Object(c["p"])("ignoreResponse"),a=Object(s["b"])(),o=Object(c["f"])((()=>a.state.db.reports)),b=Object(c["f"])((()=>a.state.db.buffers)),n=Object(c["f"])((()=>a.state.db.devices)),O=Object(c["f"])((()=>a.state.db.command)),j=Object(c["f"])((()=>a.getters["db/devDevice"])),d=Object(c["f"])((()=>a.getters["db/devReports"])),u=e=>a.commit(r["g"],e),p=e=>a.dispatch(ve["a"],e),m=Object(c["f"])((()=>a.state.common.notification)),f=e=>a.commit(i["c"],e),v=Object(c["E"])(null),g=Object(c["f"])({get:()=>m.value,set:e=>f(e)}),S=()=>Object($["a"])("Are you sure to remove all data?").onOk((()=>u())),h=()=>{if(!j.value)return;let e=d.value.find((({frameID:e})=>"FULL"==Object(I["e"])(e.val)));if(!e)return;let l=Object(I["b"])(e);l&&(t(`REPORT_RTC=${l}`),Object($["c"])("Calibrating device time..","info"))},k=([e])=>{fe(e).then((e=>p(e)))};return Object(c["R"])((()=>b.value.length),(e=>0==e&&v.value.reset())),{uploader:v,devices:n,command:O,reports:o,devReports:d,notificationState:g,calibrate:h,clearStore:S,ignoreResponse:l,importData:k,exportJSON:me,exportCSV:ue}}}),Se=l("f20b"),he=l("1c1c"),ke=l("ee89"),ye=l("9564"),He=l("7f67");ge.render=ie;var qe=ge;y()(ge,"components",{QBtn:S["a"],QBtnDropdown:Se["a"],QList:he["a"],QItem:p["a"],QItemSection:m["a"],QItemLabel:v["a"],QUploader:ke["a"],QToggle:ye["a"]}),y()(ge,"directives",{ClosePopup:He["a"]});var _e=Object(c["m"])({components:{MapManagement:U,ReportLog:H,DriverManagement:X,GlobalConfiguration:qe},setup(e){const t=Object(s["b"])(),l=Object(c["f"])((()=>t.getters["db/devReports"])),a=Object(c["f"])((()=>t.getters["db/devFingers"])),o=Object(c["E"])("tab-1"),b=Object(c["E"])(50),n=Object(c["f"])((()=>`height: calc(100vh - ${b.value}vh - 95px)`));return{selectedTab:o,splitter:b,devReports:l,devFingers:a,contentStyle:n}}}),we=l("9989"),Ce=l("429b"),xe=l("7460"),Qe=l("58a81"),De=l("adad"),Re=l("823b");_e.render=a;t["default"]=_e;y()(_e,"components",{QPage:we["a"],QSplitter:z["a"],QAvatar:E["a"],QTabs:Ce["a"],QTab:xe["a"],QBadge:Qe["a"],QTabPanels:De["a"],QTabPanel:Re["a"]})}}]);